<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>YouSearch — YouTube-style Dark Player</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<style>
  :root{
    --bg:#05060a;
    --panel:#0b0f14;
    --card: rgba(255,255,255,0.03);
    --accent:#ff3b3b;
    --muted:rgba(255,255,255,0.75);
    --glass: rgba(255,255,255,0.02);
    --maxWidth:1200px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,var(--bg),#000);color:#fff;min-height:100vh;-webkit-font-smoothing:antialiased}
  .wrap{max-width:var(--maxWidth);margin:12px auto;padding:12px}

  header{display:flex;flex-wrap:wrap;justify-content:space-between;gap:12px;align-items:center}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:52px;height:52px;border-radius:10px;background:linear-gradient(90deg,#ff9b9b,#ff3b3b);display:flex;align-items:center;justify-content:center;font-weight:700;color:#120}
  h1{margin:0;font-size:1.15rem}
  .small{font-size:0.86rem;color:var(--muted)}

  .searchbar{display:flex;gap:8px;align-items:center;margin-left:auto}
  input[type="search"]{padding:10px 12px;border-radius:10px;border:0;min-width:220px;background:rgba(255,255,255,0.02);color:#fff}
  button.btn{background:linear-gradient(90deg,#ff7b7b,#ff3b3b);border:0;padding:10px 12px;border-radius:10px;color:#120;font-weight:700;cursor:pointer}

  .layout{display:grid;grid-template-columns: 1fr 360px; gap:16px; margin-top:14px}
  @media (max-width:980px){ .layout{grid-template-columns:1fr} .sidebar{order:2} .logo{width:44px;height:44px} }

  /* player */
  .player-card{background:var(--panel);border-radius:12px;padding:0;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.6)}
  .player-frame{position:relative;width:100%;aspect-ratio:16/9;background:#000}
  #player{width:100%;height:100%;}
  .spinner{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:48px;height:48px;border-radius:50%;border:6px solid rgba(255,255,255,0.06);border-top-color:var(--accent);animation:spin 1s linear infinite;display:none;z-index:10}
  @keyframes spin{to{transform:rotate(360deg)}}

  .player-info{display:flex;justify-content:space-between;gap:8px;padding:12px;background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.02))}
  .meta-left{max-width:72%}
  .title-now{font-weight:700;font-size:1rem}
  .meta-right{display:flex;gap:8px;align-items:center;color:var(--muted);font-size:0.95rem}

  .controls{display:flex;gap:8px;align-items:center}
  .control-btn{background:rgba(255,255,255,0.02);border-radius:8px;padding:8px;cursor:pointer;border:0;color:var(--accent)}
  .control-btn:hover{transform:translateY(-3px);box-shadow:0 10px 30px rgba(255,59,59,0.06)}

  /* results */
  .results{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:12px;padding:6px}
  .card{background:var(--card);border-radius:10px;padding:8px;display:flex;gap:10px;cursor:pointer;border:1px solid rgba(255,255,255,0.02)}
  .card img{width:170px;height:96px;object-fit:cover;border-radius:7px;flex-shrink:0}
  .cmeta{display:flex;flex-direction:column;gap:6px}
  .ctitle{font-weight:700}
  .csub{color:var(--muted);font-size:0.86rem}

  .sidebar{background:var(--card);border-radius:10px;padding:10px;max-height:65vh;overflow:auto}
  .load-more{display:block;margin:12px auto;padding:10px 12px;border-radius:10px;border:0;background:linear-gradient(90deg,#ff7b7b,#ff3b3b);color:#120;font-weight:700;cursor:pointer}

  footer{margin-top:16px;color:var(--muted);text-align:center;font-size:0.9rem}
  .active{outline:2px solid rgba(255,59,59,0.12);box-shadow:0 30px 60px rgba(255,59,59,0.06)}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="brand">
      <div class="logo">YT</div>
      <div>
        <h1>YouSearch — YouTube-style Dark</h1>
        <div class="small">Global search + play (full YouTube) — mobile friendly</div>
      </div>
    </div>

    <div class="searchbar">
      <input id="searchInput" type="search" placeholder="Search videos, drama, episode, channel..." />
      <button id="searchBtn" class="btn">Search</button>
    </div>
  </header>

  <div class="layout">
    <main>
      <div class="player-card">
        <div class="player-frame">
          <div id="spinner" class="spinner" aria-hidden="true"></div>
          <div id="player"></div>
        </div>

        <div class="player-info">
          <div class="meta-left">
            <div id="nowTitle" class="title-now">No video selected</div>
            <div id="nowDesc" class="small">Search the whole YouTube and click a result to play</div>
          </div>
          <div class="meta-right">
            <div id="nowStats" class="small">—</div>
            <div class="controls">
              <button id="playBtn" class="control-btn" title="Play/Pause"><i id="playIcon" class="fa-solid fa-play"></i></button>
              <button id="muteBtn" class="control-btn" title="Mute/Unmute"><i id="muteIcon" class="fa-solid fa-volume-high"></i></button>
              <input id="volSlider" type="range" min="0" max="100" value="100" style="width:110px">
              <button id="fsBtn" class="control-btn" title="Fullscreen"><i class="fa-solid fa-expand"></i></button>
            </div>
          </div>
        </div>
      </div>

      <section id="results" class="results" aria-live="polite"></section>
      <button id="loadMore" class="load-more" style="display:none">Load more</button>
    </main>

    <aside class="sidebar">
      <strong>Info</strong>
      <div style="margin-top:10px" id="sidebarInfo">
        <div class="small">Tip: use search terms like "Drama name episode 5" or channel names for precise results.</div>
      </div>
    </aside>
  </div>

  <footer>Made for you — remember to restrict API key referrers in Google Cloud Console</footer>
</div>

<!-- YouTube IFrame API -->
<script src="https://www.youtube.com/iframe_api"></script>

<script>
/* ---------------- CONFIG ---------------- */
const API_KEY = 'AIzaSyDabc123XYZ'; // your provided key inserted
const MAX_RESULTS = 12;             // results per page
let nextPageToken = null;

/* --------------- UI refs --------------- */
const searchInput = document.getElementById('searchInput');
const searchBtn = document.getElementById('searchBtn');
const resultsEl = document.getElementById('results');
const loadMoreBtn = document.getElementById('loadMore');
const spinner = document.getElementById('spinner');
const nowTitle = document.getElementById('nowTitle');
const nowDesc = document.getElementById('nowDesc');
const nowStats = document.getElementById('nowStats');

const playBtn = document.getElementById('playBtn');
const playIcon = document.getElementById('playIcon');
const muteBtn = document.getElementById('muteBtn');
const muteIcon = document.getElementById('muteIcon');
const volSlider = document.getElementById('volSlider');
const fsBtn = document.getElementById('fsBtn');

let ytPlayer = null;
let videoList = []; // {id,title,thumb,desc,published,duration,views}
let currentVideoId = null;

/* spinner helper */
function showSpinner(on){ spinner.style.display = on ? 'block' : 'none'; }

/* YouTube IFrame API ready */
function onYouTubeIframeAPIReady(){
  ytPlayer = new YT.Player('player', {
    height: '100%',
    width: '100%',
    videoId: '',
    playerVars: { rel:0, modestbranding:1 },
    events: { onReady: ()=> { ytPlayer.setVolume(Number(volSlider.value)); }, onStateChange: onPlayerStateChange }
  });
}
function onPlayerStateChange(e){
  playIcon.className = (e.data === YT.PlayerState.PLAYING) ? 'fa-solid fa-pause' : 'fa-solid fa-play';
}

/* Helpers */
function escapeHtml(s){ return (s||'').replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
function formatNumber(n){ return n ? n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") : '0'; }
function parseISO8601(d){
  if(!d) return '';
  let h=0,m=0,s=0, rest=d.replace('PT','');
  const match = rest.match(/(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/);
  if(match){ if(match[1]) h=+match[1]; if(match[2]) m=+match[2]; if(match[3]) s=+match[3]; }
  return (h? h+':' : '') + String(m).padStart(h?2:1,'0') + ':' + String(s).padStart(2,'0');
}

/* Search (search.list -> videos.list) */
async function searchYouTube(query, pageToken = null){
  if(!API_KEY || API_KEY === 'YOUR_API_KEY_HERE'){ resultsEl.innerHTML = '<div style="padding:12px;color:#f88">Add API key in code.</div>'; return; }
  showSpinner(true);

  const sUrl = new URL('https://www.googleapis.com/youtube/v3/search');
  sUrl.searchParams.set('part','snippet');
  sUrl.searchParams.set('q', query);
  sUrl.searchParams.set('type','video');
  sUrl.searchParams.set('maxResults', MAX_RESULTS);
  if(pageToken) sUrl.searchParams.set('pageToken', pageToken);
  sUrl.searchParams.set('key', API_KEY);

  const sResp = await fetch(sUrl.toString());
  if(!sResp.ok){ showSpinner(false); throw new Error('Search API error: '+sResp.status); }
  const sData = await sResp.json();
  nextPageToken = sData.nextPageToken || null;

  const ids = sData.items.map(it => it.id.videoId).join(',');
  const vUrl = new URL('https://www.googleapis.com/youtube/v3/videos');
  vUrl.searchParams.set('part','snippet,contentDetails,statistics');
  vUrl.searchParams.set('id', ids);
  vUrl.searchParams.set('key', API_KEY);

  const vResp = await fetch(vUrl.toString());
  if(!vResp.ok){ showSpinner(false); throw new Error('Videos API error: '+vResp.status); }
  const vData = await vResp.json();

  const map = {};
  vData.items.forEach(it => {
    map[it.id] = {
      id: it.id,
      title: it.snippet.title,
      desc: it.snippet.description,
      published: it.snippet.publishedAt,
      thumb: it.snippet.thumbnails?.high?.url || it.snippet.thumbnails?.default?.url,
      duration: it.contentDetails?.duration,
      views: it.statistics?.viewCount || 0
    };
  });

  const pageList = sData.items.map(it => map[it.id.videoId]).filter(Boolean);
  if(!pageToken){ videoList = pageList; resultsEl.innerHTML = ''; } else { videoList = videoList.concat(pageList); }

  renderResults(pageToken ? true : false);
  showSpinner(false);
}

/* render results */
function renderResults(appending = false){
  if(!appending) resultsEl.innerHTML = '';
  videoList.forEach((v,i) => {
    if(document.querySelector(`.card[data-vid="${v.id}"]`)) return;
    const el = document.createElement('div');
    el.className = 'card';
    el.dataset.vid = v.id;
    el.dataset.index = i;
    el.innerHTML = `
      <img src="${v.thumb}" alt="${escapeHtml(v.title)}">
      <div class="cmeta">
        <div class="ctitle">${escapeHtml(v.title)}</div>
        <div class="csub">${formatNumber(v.views)} views • ${parseISO8601(v.duration)} • ${new Date(v.published).toLocaleDateString()}</div>
      </div>
    `;
    el.addEventListener('click', ()=> playVideoById(v.id));
    resultsEl.appendChild(el);
  });
  loadMoreBtn.style.display = nextPageToken ? 'block' : 'none';
}

/* play video */
function playVideoById(id){
  if(!ytPlayer) return;
  currentVideoId = id;
  ytPlayer.loadVideoById(id);
  const v = videoList.find(x=>x.id===id);
  nowTitle.textContent = v ? v.title : 'Playing';
  nowDesc.textContent = v ? (v.desc.slice(0,220) + (v.desc.length>220? '…':'')) : '';
  nowStats.textContent = v ? `${formatNumber(v.views)} views` : '';
  ytPlayer.setVolume(Number(volSlider.value));
  document.querySelectorAll('.card').forEach(c=> c.classList.toggle('active', c.dataset.vid===id));
}

/* UI wiring */
searchBtn.addEventListener('click', ()=> {
  const q = (searchInput.value||'').trim();
  if(!q) return;
  nextPageToken = null;
  searchYouTube(q).catch(err => resultsEl.innerHTML = `<div style="padding:12px;color:#f88">Error: ${err.message}</div>`);
});
searchInput.addEventListener('keydown', (e)=> { if(e.key==='Enter') searchBtn.click(); });

loadMoreBtn.addEventListener('click', ()=> {
  if(!nextPageToken) return;
  const q = (searchInput.value||'').trim();
  searchYouTube(q, nextPageToken).catch(err => resultsEl.innerHTML = `<div style="padding:12px;color:#f88">Error: ${err.message}</div>`);
});

playBtn.addEventListener('click', ()=> {
  if(!ytPlayer) return;
  const st = ytPlayer.getPlayerState();
  if(st === YT.PlayerState.PLAYING) ytPlayer.pauseVideo();
  else ytPlayer.playVideo();
});
muteBtn.addEventListener('click', ()=> {
  if(!ytPlayer) return;
  if(ytPlayer.isMuted()){ ytPlayer.unMute(); muteIcon.className='fa-solid fa-volume-high'; }
  else { ytPlayer.mute(); muteIcon.className='fa-solid fa-volume-xmark'; }
});
volSlider.addEventListener('input', ()=> { if(ytPlayer) ytPlayer.setVolume(Number(volSlider.value)); });
fsBtn.addEventListener('click', ()=> {
  const el = document.querySelector('.player-card') || document.querySelector('.player-frame');
  if(!document.fullscreenElement) el.requestFullscreen().catch(()=>{}); else document.exitFullscreen().catch(()=>{});
});

/* keyboard: space toggle, arrows seek */
document.addEventListener('keydown', (e)=> {
  if(e.code === 'Space'){ e.preventDefault(); playBtn.click(); }
  if(e.code === 'ArrowRight'){ if(ytPlayer) ytPlayer.seekTo((ytPlayer.getCurrentTime()||0)+10, true); }
  if(e.code === 'ArrowLeft'){ if(ytPlayer) ytPlayer.seekTo(Math.max(0,(ytPlayer.getCurrentTime()||0)-10), true); }
});

/* initial default search */
window.addEventListener('load', ()=> {
  searchInput.value = 'Sinf-e-Aahan';
  searchBtn.click();
});
</script>
</body>
</html>
